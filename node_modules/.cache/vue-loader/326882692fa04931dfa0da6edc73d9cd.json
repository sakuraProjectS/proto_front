{"remainingRequest":"/Users/ohirashunpei/project/sakura-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ohirashunpei/project/sakura-front/src/views/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/ohirashunpei/project/sakura-front/src/views/Login.vue","mtime":1627251389701},{"path":"/Users/ohirashunpei/project/sakura-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ohirashunpei/project/sakura-front/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/ohirashunpei/project/sakura-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ohirashunpei/project/sakura-front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICdAL2FwaS9pbmRleCcKCgpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGZpcnN0bmFtZTogIiIsCiAgICAgIGxhc3RuYW1lOiAiIiwKICAgICAgbmFtZTogIiIsCiAgICAgIGVtYWlsOiAiIiwKICAgICAgcGFzc3dvcmQ6ICIiLAogICAgICB1c2VyOiB7fSwKICAgICAgbG9naW5fc3RhdHVzOiBmYWxzZSwKICAgIH07CiAgfSwKCiAgLy8gbW91bnRlZCgpIHsKICAvLyAgICAgaWYgKHRoaXMuJHN0b3JlLnN0YXRlLmxvZ2luX3N0YXR1cykgewogIC8vICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHtuYW1lOiAnVGltZUxpbmUnfSkKICAvLyAgICAgfQogIC8vIH0sCgogIG1ldGhvZHM6IHsKICAgIGFzeW5jIHNpZ25VcCgpIHsKICAgICAgdGhpcy5uYW1lID10aGlzLmxhc3RuYW1lICsgIiAiICt0aGlzLmZpcnN0bmFtZQoKICAgICAgYXdhaXQgYXhpb3MoKQogICAgICAgIC5wb3N0KCIvYXV0aCIsIHsKICAgICAgICAgIGVtYWlsOiB0aGlzLmVtYWlsLAogICAgICAgICAgcGFzc3dvcmQ6IHRoaXMucGFzc3dvcmQsCiAgICAgICAgfSkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKQogICAgICAgICAgdGhpcy51c2VyID0gewogICAgICAgICAgICB1aWQ6IHJlc3BvbnNlLmhlYWRlcnNbInVpZCJdLAogICAgICAgICAgICAiYWNjZXNzLXRva2VuIjogcmVzcG9uc2UuaGVhZGVyc1siYWNjZXNzLXRva2VuIl0sCiAgICAgICAgICAgIGNsaWVudDogcmVzcG9uc2UuaGVhZGVyc1siY2xpZW50Il0sCiAgICAgICAgICAgIGlkOiByZXNwb25zZS5kYXRhLmRhdGFbImlkIl0sCiAgICAgICAgICB9LAogICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3VzZXJMb2dpbicsIHRoaXMudXNlcikKICAgICAgICB9KTsKICAgICAgYXdhaXQgYXhpb3MoKS5wdXQoJy91c2Vycy8nICsgdGhpcy51c2VyWyJpZCJdLCB7CiAgICAgICAgZW1haWw6IHRoaXMuZW1haWwsCiAgICAgICAgcGFzc3dvcmQ6IHRoaXMucGFzc3dvcmQsCiAgICAgICAgbmFtZTogdGhpcy5uYW1lCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgJ2FjY2Vzcy10b2tlbic6IHRoaXMudXNlclsiYWNjZXNzLXRva2VuIl0sCiAgICAgICAgICAgIHVpZDogdGhpcy51c2VyWyJ1aWQiXSwKICAgICAgICAgICAgY2xpZW50OiB0aGlzLnVzZXJbImNsaWVudCJdLAogICAgICAgICAgfSwKICAgICAgfQogICAgICApCiAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdrZWVwTG9naW4nLCB0aGlzLnN0YXR1cykKICAgICAgaWYgKHRoaXMuZW1haWwgPT0gdGhpcy51c2VyWyJ1aWQiXSl7CiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHtuYW1lOiAnVGltZUxpbmUnfSkKICAgICAgfQogICAgfSwKCiAgICBzaWduSW4oKSB7CiAgICAgIGF4aW9zKCkKICAgICAgICAucG9zdCgiL2F1dGgvc2lnbl9pbiIsIHsKICAgICAgICAgIGVtYWlsOiB0aGlzLmVtYWlsLAogICAgICAgICAgcGFzc3dvcmQ6IHRoaXMucGFzc3dvcmQsCiAgICAgICAgfSkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIHRoaXMudXNlciA9IHsKICAgICAgICAgICAgdWlkOiByZXNwb25zZS5oZWFkZXJzWyJ1aWQiXSwKICAgICAgICAgICAgImFjY2Vzcy10b2tlbiI6IHJlc3BvbnNlLmhlYWRlcnNbImFjY2Vzcy10b2tlbiJdLAogICAgICAgICAgICBjbGllbnQ6IHJlc3BvbnNlLmhlYWRlcnNbImNsaWVudCJdLAogICAgICAgICAgICBpZDogcmVzcG9uc2UuZGF0YS5kYXRhWyJpZCJdLAogICAgICAgICAgfSwKICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMubG9naW5fc3RhdHVzKQogICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3VzZXJMb2dpbicsIHRoaXMudXNlcikKICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdrZWVwTG9naW4nLCB0aGlzLmxvZ2luX3N0YXR1cykKICAgICAgICAgIGlmICh0aGlzLmVtYWlsID09IHRoaXMudXNlclsidWlkIl0pewogICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7bmFtZTogJ1RpbWVMaW5lJ30pCiAgICAgICAgICB9CiAgICAgICAgfSk7ICAgIAogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+FA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <v-container>\n        <v-row justify=\"center\" class=\"mt-5\">\n            <img src=\"../assets/img/sakura-logo.png\" width=\"180\" height=\"180\">\n        </v-row>\n        <v-layout wrap class='justify-center'>\n          <v-flex xs12 sm10 md8>\n            <v-row class=\"ml-3 mr-3 mt-7\">\n                <v-col>\n                    <v-text-field\n                        v-model=\"lastname\"\n                        label=\"姓\"\n                        outlined\n                        filled\n                        rounded\n                        background-color=\"grey lighten-5\"\n                    ></v-text-field>\n                </v-col>\n                <v-col>\n                    <v-text-field\n                        v-model=\"firstname\"\n                        label=\"名\"\n                        outlined\n                        filled\n                        rounded\n                        background-color=\"grey lighten-5\"\n                    ></v-text-field>\n                </v-col>\n            </v-row>\n            <v-row class=\"ml-3 mr-3 mt-n7\"> \n                <v-col>\n                    <v-text-field\n                        v-model=\"email\"\n                        label=\"メールアドレス\"\n                        outlined\n                        filled\n                        rounded\n                        background-color=\"grey lighten-5\"\n                    ></v-text-field>\n                </v-col>\n            </v-row>\n              <v-row class=\"ml-3 mr-3 mt-n7\"> \n                <v-col>\n                    <v-text-field\n                        v-model=\"password\"\n                        type=\"password\"\n                        label=\"パスワード\"\n                        outlined\n                        filled\n                        rounded\n                        background-color=\"grey lighten-5\"\n                    ></v-text-field>\n                </v-col>\n              </v-row>\n          </v-flex>\n        </v-layout>\n        <div class=\"text-center\">\n            <v-row class=\"mt-n5\" align=\"center\"> \n                <v-col>\n                    <v-btn\n                        depressed\n                        rounded\n                        color=\"blue lighten-3\"\n                        x-large\n                        @click=\"signIn\"\n                    >\n                        ログイン\n                    </v-btn>\n                </v-col>\n            </v-row>\n            <v-row class=\"mt-n1\" align=\"center\"> \n                <v-col>\n                    <v-btn\n                        depressed\n                        rounded\n                        color=\"grey lighten-2\"\n                        x-large\n                        @click=\"signUp\"\n                    >\n                        新規ユーザー登録\n                    </v-btn>\n                </v-col>\n            </v-row>\n            <v-row class='justify-center'>\n              <v-switch\n                v-model=\"login_status\"\n                class=\"ma-1\"\n                label=\"次回から自動ログインする\"\n              ></v-switch>\n            </v-row>\n        </div>\n    </v-container>\n</template>\n\n<script>\nimport axios from '@/api/index'\n\n\nexport default {\n  data() {\n    return {\n      firstname: \"\",\n      lastname: \"\",\n      name: \"\",\n      email: \"\",\n      password: \"\",\n      user: {},\n      login_status: false,\n    };\n  },\n\n  // mounted() {\n  //     if (this.$store.state.login_status) {\n  //       this.$router.push({name: 'TimeLine'})\n  //     }\n  // },\n\n  methods: {\n    async signUp() {\n      this.name =this.lastname + \" \" +this.firstname\n\n      await axios()\n        .post(\"/auth\", {\n          email: this.email,\n          password: this.password,\n        })\n        .then((response) => {\n          console.log(response)\n          this.user = {\n            uid: response.headers[\"uid\"],\n            \"access-token\": response.headers[\"access-token\"],\n            client: response.headers[\"client\"],\n            id: response.data.data[\"id\"],\n          },\n          this.$store.dispatch('userLogin', this.user)\n        });\n      await axios().put('/users/' + this.user[\"id\"], {\n        email: this.email,\n        password: this.password,\n        name: this.name\n      },\n      {\n        headers: {\n           'access-token': this.user[\"access-token\"],\n            uid: this.user[\"uid\"],\n            client: this.user[\"client\"],\n          },\n      }\n      )\n      this.$store.dispatch('keepLogin', this.status)\n      if (this.email == this.user[\"uid\"]){\n            this.$router.push({name: 'TimeLine'})\n      }\n    },\n\n    signIn() {\n      axios()\n        .post(\"/auth/sign_in\", {\n          email: this.email,\n          password: this.password,\n        })\n        .then((response) => {\n          this.user = {\n            uid: response.headers[\"uid\"],\n            \"access-token\": response.headers[\"access-token\"],\n            client: response.headers[\"client\"],\n            id: response.data.data[\"id\"],\n          },\n          console.log(this.login_status)\n          this.$store.dispatch('userLogin', this.user)\n          this.$store.dispatch('keepLogin', this.login_status)\n          if (this.email == this.user[\"uid\"]){\n            this.$router.push({name: 'TimeLine'})\n          }\n        });    \n    },\n  },\n};\n</script>\n\n"]}]}